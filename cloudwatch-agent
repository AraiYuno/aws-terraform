# https://aws.amazon.com/blogs/mt/amazon-ec2-systems-manager-documents-support-for-cross-platform-documents-and-multiple-steps-of-the-same-type/

# https://www.youtube.com/watch?v=z_bUDHUEWUY

# ./amazon-cloudwatch-agent-ctl --help

# https://www.youtube.com/watch?v=vAnIhIwE5hY

# https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Agent-Configuration-File-Details.html


amazon-cloudwatch-agent-ctl -a fetch-config -m ec2 -c ssm:AmazonCloudWatch-linux -s 


# https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Agent-Configuration-File-Details.html


# https://www.youtube.com/watch?v=3k2qqBh0Sns










{
	"agent": {
			"metrics_collection_interval": 60,
			"run_as_user": "root"
	},
	"metrics": {
			"append_dimensions": {
					"AutoScalingGroupName": "${aws:AutoScalingGroupName}",
					"ImageId": "${aws:ImageId}",
					"InstanceId": "${aws:InstanceId}",
					"InstanceType": "${aws:InstanceType}"
			},
			"metrics_collected": {
					"collectd": {
							"metrics_aggregation_interval": 60
					},
					"cpu": {
							"measurement": [
									"cpu_usage_idle",
									"cpu_usage_iowait",
									"cpu_usage_user",
									"cpu_usage_system"
							],
							"metrics_collection_interval": 60,
							"totalcpu": false
					},
					"disk": {
							"measurement": [
									"used_percent",
									"inodes_free"
							],
							"metrics_collection_interval": 60,
							"resources": [
									"*"
							]
					},
					"diskio": {
							"measurement": [
									"io_time"
							],
							"metrics_collection_interval": 60,
							"resources": [
									"*"
							]
					},
					"mem": {
							"measurement": [
									"mem_used_percent"
							],
							"metrics_collection_interval": 60
					},
					"statsd": {
							"metrics_aggregation_interval": 60,
							"metrics_collection_interval": 60,
							"service_address": ":8125"
					},
					"swap": {
							"measurement": [
									"swap_used_percent"
							],
							"metrics_collection_interval": 60
					}
			}
	}
}
