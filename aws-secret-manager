#Install mentioned below packages

yum update -y
yum install mysql -y
yum install jq -y

# https://docs.aws.amazon.com/cli/latest/reference/secretsmanager/get-secret-value.html

aws secretsmanager get-secret-value --secret-id MySQLSecret --region eu-central-1 | jq fromjson


aws secretsmanager get-secret-value --secret-id MySQLSecret --region eu-central-1 | jq .SecretString | jq fromjson | jq -r .username


aws secretsmanager get-secret-value --secret-id MySQLSecret --region eu-central-1 | jq .SecretString | jq fromjson | jq -r .password


aws secretsmanager get-secret-value --secret-id MySQLSecret --region eu-central-1 | jq .SecretString | jq fromjson | jq -r .host

 
aws secretsmanager get-secret-value --secret-id MySQLSecret --region eu-central-1 | jq .SecretString | jq fromjson | jq -r .port







# Secret-Manager-Policy


  policy = <<EOF
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Action": [
        "secretsmanager:GetResourcePolicy",
        "secretsmanager:GetSecretValue",
        "secretsmanager:DescribeSecret",
        "secretsmanager:ListSecretVersionIds"
      ],
      "Effect": "Allow",
      "Resource": ["arn:aws:secretsmanager:*:*:secret:${var.name}"]
    }
  ]
}
EOF
}
